<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0A0A0A">
<title>Laith's Music Brand App</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=DM+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
  
  :root {
    --gold: #C9A84C;
    --gold-light: #E8C46A;
    --bg: #0A0A0A;
    --surface: #111111;
    --border: #1E1E1E;
    --text: #F0EDE6;
    --muted: #888888;
    --dim: #444444;
    --red: #FF1744;
  }

  body {
    font-family: 'Georgia', serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    min-height: 100dvh;
    overflow-x: hidden;
  }

  .mono { font-family: 'DM Mono', monospace; }
  .playfair { font-family: 'Playfair Display', serif; }

  /* HEADER */
  header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(10,10,10,0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
    padding: 14px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .header-label { font-family: 'DM Mono', monospace; font-size: 0.6rem; letter-spacing: 0.2em; color: var(--gold); text-transform: uppercase; }
  .header-sub { font-family: 'DM Mono', monospace; font-size: 0.55rem; color: var(--dim); letter-spacing: 0.1em; }

  /* MAIN */
  main { padding: 32px 20px 80px; max-width: 600px; margin: 0 auto; }

  /* HERO */
  .hero { margin-bottom: 36px; }
  .hero h1 { font-family: 'Playfair Display', serif; font-size: 2.2rem; font-weight: 400; line-height: 1.15; margin-bottom: 12px; }
  .hero h1 em { color: var(--gold); font-style: italic; }
  .hero p { color: var(--muted); font-size: 0.88rem; line-height: 1.7; }

  /* INPUT */
  .input-label { font-family: 'DM Mono', monospace; font-size: 0.6rem; letter-spacing: 0.15em; color: var(--dim); text-transform: uppercase; display: block; margin-bottom: 12px; }
  textarea {
    width: 100%;
    background: transparent;
    border: none;
    border-bottom: 1px solid #333;
    color: var(--text);
    font-family: 'Georgia', serif;
    font-size: 1rem;
    padding: 10px 0;
    outline: none;
    resize: none;
    -webkit-appearance: none;
    line-height: 1.6;
  }
  textarea:focus { border-bottom-color: var(--gold); }
  textarea::placeholder { color: #333; font-style: italic; }

  /* BUTTON */
  .btn {
    display: block;
    width: 100%;
    background: var(--gold);
    color: #0A0A0A;
    border: none;
    padding: 16px;
    font-family: 'DM Mono', monospace;
    font-size: 0.72rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    cursor: pointer;
    margin-top: 20px;
    -webkit-appearance: none;
    border-radius: 0;
    transition: background 0.2s;
  }
  .btn:active { background: var(--gold-light); }
  .btn:disabled { background: #222; color: #555; cursor: not-allowed; }

  .btn-ghost {
    background: transparent;
    color: var(--muted);
    border: 1px solid #2A2A2A;
    width: 100%;
    padding: 14px;
    font-family: 'DM Mono', monospace;
    font-size: 0.65rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    cursor: pointer;
    margin-top: 32px;
    border-radius: 0;
  }

  /* LOADING */
  .loading-state { text-align: center; padding: 48px 0; }
  .loading-dot { display: inline-block; width: 6px; height: 6px; background: var(--gold); border-radius: 50%; margin: 0 4px; animation: bounce 1.2s infinite; }
  .loading-dot:nth-child(2) { animation-delay: 0.2s; }
  .loading-dot:nth-child(3) { animation-delay: 0.4s; }
  @keyframes bounce { 0%,80%,100%{transform:translateY(0)} 40%{transform:translateY(-8px)} }
  .loading-text { font-family: 'DM Mono', monospace; font-size: 0.65rem; color: var(--dim); letter-spacing: 0.1em; margin-top: 16px; }

  /* DIVIDER */
  .divider { height: 1px; background: var(--border); margin: 28px 0; }

  /* CARDS */
  .card { background: var(--surface); border: 1px solid var(--border); padding: 18px; margin-bottom: 16px; }
  .card-label { font-family: 'DM Mono', monospace; font-size: 0.58rem; letter-spacing: 0.15em; color: var(--dim); text-transform: uppercase; margin-bottom: 12px; }
  .card-label.gold { color: var(--gold); }
  .card-label.red { color: var(--red); }

  /* PITCH LINE */
  .pitch-card { border-left: 3px solid var(--gold); }
  .pitch-text { font-family: 'Playfair Display', serif; font-size: 1.05rem; font-style: italic; line-height: 1.6; color: #D4CFC6; }

  /* EMOTION TAGS */
  .emotion-primary { background: var(--gold); color: #0A0A0A; padding: 6px 14px; font-family: 'DM Mono', monospace; font-size: 0.72rem; letter-spacing: 0.05em; text-transform: capitalize; display: inline-block; margin-right: 8px; margin-bottom: 8px; }
  .emotion-secondary { background: #1A1A1A; border: 1px solid #2A2A2A; color: var(--muted); padding: 5px 12px; font-family: 'DM Mono', monospace; font-size: 0.7rem; text-transform: capitalize; display: inline-block; margin-right: 6px; margin-bottom: 6px; }

  /* MOOD BARS */
  .mood-row { margin-bottom: 14px; }
  .mood-meta { display: flex; justify-content: space-between; margin-bottom: 5px; }
  .mood-name { font-family: 'DM Mono', monospace; font-size: 0.62rem; color: var(--muted); text-transform: capitalize; }
  .mood-val { font-family: 'DM Mono', monospace; font-size: 0.62rem; color: var(--gold); }
  .mood-track { background: #1A1A1A; height: 3px; border-radius: 2px; overflow: hidden; }
  .mood-fill { height: 100%; border-radius: 2px; transition: width 1s ease; }

  /* SONIC PERSONALITY */
  .sonic-text { font-size: 0.85rem; color: var(--muted); line-height: 1.7; }

  /* GENRE CARDS */
  .genre-item { border: 1px solid var(--border); padding: 16px; margin-bottom: 12px; }
  .genre-name { font-family: 'Playfair Display', serif; font-size: 1.05rem; margin-bottom: 6px; }
  .genre-desc { font-size: 0.8rem; color: var(--muted); line-height: 1.6; margin-bottom: 12px; }
  .artist-ref { font-family: 'DM Mono', monospace; font-size: 0.62rem; color: var(--dim); margin-bottom: 4px; }
  .genre-tags { display: flex; gap: 6px; margin-top: 10px; flex-wrap: wrap; }
  .mini-tag { background: #1A1A1A; border: 1px solid #2A2A2A; padding: 3px 10px; font-family: 'DM Mono', monospace; font-size: 0.6rem; color: var(--dim); }

  /* PALETTE */
  .palette-wrap { display: flex; flex-wrap: wrap; gap: 6px; }
  .palette-tag { background: #1A1A1A; border: 1px solid #2A2A2A; padding: 5px 12px; font-family: 'DM Mono', monospace; font-size: 0.65rem; color: var(--muted); }

  /* AVOID LIST */
  .avoid-item { border-left: 2px solid var(--red); padding-left: 12px; color: var(--muted); font-size: 0.82rem; font-style: italic; margin-bottom: 10px; line-height: 1.5; }

  /* CAMPAIGN */
  .campaign-item { margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid var(--border); }
  .campaign-item:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
  .campaign-icon { font-size: 1rem; color: var(--gold); margin-bottom: 6px; }
  .campaign-label { font-family: 'DM Mono', monospace; font-size: 0.58rem; letter-spacing: 0.1em; color: #555; text-transform: uppercase; margin-bottom: 6px; }
  .campaign-text { font-size: 0.83rem; color: var(--muted); line-height: 1.6; }

  /* BRAND HEADER */
  .brand-header { margin-bottom: 28px; }
  .brand-header-eyebrow { font-family: 'DM Mono', monospace; font-size: 0.58rem; letter-spacing: 0.2em; color: var(--gold); margin-bottom: 8px; text-transform: uppercase; }
  .brand-header h2 { font-family: 'Playfair Display', serif; font-size: 1.9rem; font-weight: 400; margin-bottom: 6px; }
  .brand-header .tagline { font-family: 'Playfair Display', serif; font-size: 0.95rem; color: var(--muted); font-style: italic; }

  /* FADE IN */
  .fade-in { animation: fadeIn 0.5s ease forwards; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

  /* FOOTER */
  footer { border-top: 1px solid var(--border); padding: 16px 20px; text-align: center; }
  .footer-text { font-family: 'DM Mono', monospace; font-size: 0.55rem; color: #2A2A2A; letter-spacing: 0.1em; }

  /* SHARE BUTTON */
  .share-row { display: flex; gap: 10px; margin-top: 10px; }
  .share-row .btn { margin-top: 0; flex: 1; }
</style>
</head>
<body>

<header>
  <div>
    <div class="header-label">Laith's Music Brand App</div>
  </div>
  <div class="header-sub">BRAND → SOUND</div>
</header>

<main>
  <!-- INPUT STATE -->
  <div id="input-view">
    <div class="hero">
      <h1>What does your<br><em>brand sound like?</em></h1>
      <p>Describe your brand or campaign and get a full sonic identity brief — the kind a music supervisor or creative director would actually use.</p>
    </div>

    <label class="input-label">Describe your brand</label>
    <textarea id="brand-input" rows="5" placeholder="e.g. A sustainable streetwear brand targeting Gen Z in cities. Raw, confident, not trying too hard. Think skate culture meets high fashion. New drop campaign — dark colors, midnight release..."></textarea>

    <button class="btn" id="analyze-btn" onclick="analyze()">Generate Sonic Brief</button>
  </div>

  <!-- LOADING STATE -->
  <div id="loading-view" style="display:none;">
    <div class="loading-state">
      <div>
        <span class="loading-dot"></span>
        <span class="loading-dot"></span>
        <span class="loading-dot"></span>
      </div>
      <div class="loading-text" id="loading-text">reading brand DNA...</div>
    </div>
  </div>

  <!-- RESULT STATE -->
  <div id="result-view" style="display:none;"></div>
</main>

<footer>
  <div class="footer-text">LAITH'S MUSIC BRAND APP</div>
</footer>

<script>
const moodColors = {
  energetic: "#FF4D00", melancholic: "#6B7FD7", luxurious: "#C9A84C",
  playful: "#FF6B9D", mysterious: "#8B5CF6", organic: "#4CAF76",
  aggressive: "#FF1744", ethereal: "#7DD3FC"
};

const loadingMessages = [
  "reading brand DNA...", "analyzing emotional profile...",
  "consulting the sonic archives...", "building your brief..."
];

async function analyze() {
  const brand = document.getElementById('brand-input').value.trim();
  if (!brand) return;

  document.getElementById('input-view').style.display = 'none';
  document.getElementById('loading-view').style.display = 'block';

  let msgIdx = 0;
  const msgInterval = setInterval(() => {
    msgIdx = (msgIdx + 1) % loadingMessages.length;
    document.getElementById('loading-text').textContent = loadingMessages[msgIdx];
  }, 1800);

  const prompt = `You are a music supervisor and brand strategist at a top creative agency. A client just described their brand. Analyze it and produce a complete sonic identity brief.

Brand Description: "${brand}"

Respond ONLY in this exact JSON format, no markdown, no extra text:
{
  "brandName": "extracted or inferred brand name",
  "tagline": "a 6-8 word sonic positioning statement you create for them",
  "emotionalProfile": {
    "primary": "one word emotion",
    "secondary": "one word emotion",
    "tertiary": "one word emotion"
  },
  "sonicPersonality": "2-3 sentence description of this brand's sound DNA",
  "moodScore": {
    "energetic": 0-100,
    "melancholic": 0-100,
    "luxurious": 0-100,
    "playful": 0-100,
    "mysterious": 0-100,
    "organic": 0-100,
    "aggressive": 0-100,
    "ethereal": 0-100
  },
  "musicDirections": [
    { "genre": "genre name", "description": "why this fits", "artists": ["3 real artist names"], "bpm": "tempo range", "key": "musical key" },
    { "genre": "genre name", "description": "why this fits", "artists": ["3 real artist names"], "bpm": "tempo range", "key": "musical key" },
    { "genre": "genre name", "description": "why this fits", "artists": ["3 real artist names"], "bpm": "tempo range", "key": "musical key" }
  ],
  "instrumentalPalette": ["5-7 specific instruments or sound elements"],
  "avoidList": ["3-4 things to absolutely avoid sonically"],
  "campaignUseCase": {
    "heroSpot": "what music to use for flagship TV/digital ad",
    "socialContent": "what works for TikTok/Reels/short content",
    "retail": "what plays in stores or branded spaces"
  },
  "pitchLine": "one punchy sentence a music supervisor would say to sell this direction to the client"
}`;

  try {
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model: "claude-sonnet-4-20250514",
        max_tokens: 1000,
        messages: [{ role: "user", content: prompt }]
      })
    });

    const data = await response.json();
    const text = data.content.map(i => i.text || "").join("");
    const clean = text.replace(/```json|```/g, "").trim();
    const result = JSON.parse(clean);

    clearInterval(msgInterval);
    renderResult(result);
  } catch (err) {
    clearInterval(msgInterval);
    document.getElementById('loading-view').style.display = 'none';
    document.getElementById('input-view').style.display = 'block';
    alert("Something went wrong. Please try again.");
  }
}

function renderResult(r) {
  document.getElementById('loading-view').style.display = 'none';

  const topMoods = Object.entries(r.moodScore).sort((a,b) => b[1]-a[1]).slice(0,5);

  const html = `
    <div class="fade-in">

      <div class="brand-header">
        <div class="brand-header-eyebrow">Sonic Identity Brief</div>
        <h2>${r.brandName}</h2>
        <div class="tagline">${r.tagline}</div>
      </div>

      <div class="card pitch-card" style="margin-bottom:16px;">
        <div class="card-label gold">The Pitch</div>
        <div class="pitch-text">"${r.pitchLine}"</div>
      </div>

      <div class="card" style="margin-bottom:16px;">
        <div class="card-label">Emotional Profile</div>
        <div style="margin-bottom:14px;">
          <span class="emotion-primary">${r.emotionalProfile.primary}</span>
          <span class="emotion-secondary">${r.emotionalProfile.secondary}</span>
          <span class="emotion-secondary">${r.emotionalProfile.tertiary}</span>
        </div>
        <div class="sonic-text">${r.sonicPersonality}</div>
      </div>

      <div class="card" style="margin-bottom:16px;">
        <div class="card-label">Mood Radar</div>
        ${topMoods.map(([mood, score]) => `
          <div class="mood-row">
            <div class="mood-meta">
              <span class="mood-name">${mood}</span>
              <span class="mood-val">${score}</span>
            </div>
            <div class="mood-track">
              <div class="mood-fill" style="width:${score}%; background:${moodColors[mood] || '#C9A84C'};"></div>
            </div>
          </div>
        `).join('')}
      </div>

      <div class="card-label" style="margin-bottom:12px; padding: 0 2px;">Music Directions</div>
      ${r.musicDirections.map(d => `
        <div class="genre-item">
          <div class="genre-name">${d.genre}</div>
          <div class="genre-desc">${d.description}</div>
          ${d.artists.map(a => `<div class="artist-ref">↗ ${a}</div>`).join('')}
          <div class="genre-tags">
            <span class="mini-tag">${d.bpm}</span>
            <span class="mini-tag">${d.key}</span>
          </div>
        </div>
      `).join('')}

      <div class="card" style="margin-bottom:16px;">
        <div class="card-label">Instrumental Palette</div>
        <div class="palette-wrap">
          ${r.instrumentalPalette.map(i => `<span class="palette-tag">${i}</span>`).join('')}
        </div>
      </div>

      <div class="card" style="margin-bottom:16px;">
        <div class="card-label red">Avoid List</div>
        ${r.avoidList.map(i => `<div class="avoid-item">${i}</div>`).join('')}
      </div>

      <div class="card" style="margin-bottom:16px;">
        <div class="card-label">Campaign Application</div>
        <div class="campaign-item">
          <div class="campaign-icon">▶</div>
          <div class="campaign-label">Hero Spot (TV / Digital)</div>
          <div class="campaign-text">${r.campaignUseCase.heroSpot}</div>
        </div>
        <div class="campaign-item">
          <div class="campaign-icon">◈</div>
          <div class="campaign-label">Social (TikTok / Reels)</div>
          <div class="campaign-text">${r.campaignUseCase.socialContent}</div>
        </div>
        <div class="campaign-item">
          <div class="campaign-icon">◎</div>
          <div class="campaign-label">Retail / Branded Space</div>
          <div class="campaign-text">${r.campaignUseCase.retail}</div>
        </div>
      </div>

      <button class="btn-ghost" onclick="reset()">← New Brief</button>
    </div>
  `;

  const view = document.getElementById('result-view');
  view.innerHTML = html;
  view.style.display = 'block';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function reset() {
  document.getElementById('result-view').style.display = 'none';
  document.getElementById('result-view').innerHTML = '';
  document.getElementById('brand-input').value = '';
  document.getElementById('input-view').style.display = 'block';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Enter key support
document.addEventListener('keydown', (e) => {
  if (e.key === 'Enter' && e.metaKey) analyze();
});
</script>
</body>
</html>
